# TIL - DB 인덱스

## 📅 날짜
[2024-12-11]

---

## 📌 학습 키워드
- [SQL Injection]

---

## 📖 오늘 배운 내용

> **SQL Injection 이란 ?**: 공격자가 어플리케이션의 취약점을 이용해 실행하는 SQL 쿼리에 악의적인 코드를 삽입하는 공격 기법, 주로 입력 필드나 URL 매개변수를 통해 이루어지며 DB에 직접적으로 접근하여 수정, 삭제 등 심각한 결과를 초래할 수 있다.

- SQL Injection 예시 : 
  1. 어플리케이션에서 사용자 입력을 검증하지 않고 SQL 쿼리로 전달할때 발생
  2. 취약한 코드 예시 
  3. 1번 예시의 코드를 직접적으로 입력받을떄 userInput 이 ' OR '1' = 1 이면 
  4. 2번 결과와 같이 sql 쿼리를 실행해 항상 참이되는 점을 이용해 모든 사용자의 데이터를 반환할 수 있다.

- 1번 예시 
>```kotlin
>val query: String = "SELECT * FROM users Where username = '" + userInput +"'"
>```

- 2번 결과
>```mysql
>SELECT * FROM users WHERE username = '' OR '1'='1';
>```


--------


> 해결법 : 
> 1. Prepared Statement 를 사용한다 : 매개변수를 바인딩하여 직접 쿼리에 포함 안하므로 공격 예방 가능
> 2. ORM (Hibernate, JPA) 같은 ORM 을 이용하여 SQL 쿼리를 직접적으로 작성하지 않는다.
> 3. 입력 검증 : 특수문자나 의도를 가지고 실행할 수 있는 --, ', ;, /* */ 같은 특수문자를 필터링하거나 금지 한다.
> 4. 데이터 베이스 권한 분리 
> 5. 에러 메시지 숨기기